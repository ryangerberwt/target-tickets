<script>
    function displayPopup(storedData) {
        var regex = new RegExp(storedData.carName.toLowerCase().replaceAll(" ", "-"));
        return regex.test(window.location.pathname);
    }
</script>
<script>
    var $ = jQuery;
    var targetErrors = targetErrors || [];


    function storePopinState(last_closed, display_count) {
        let objs = {
            last_closed_time: last_closed, alert_display_count: display_count
        }
        localStorage.setItem('popinState', JSON.stringify(objs));
        console.log('local storage');
        console.log(JSON.parse(localStorage.getItem('popinState')));
    }

    //For some reason CSS classes don't get added.
    //Let's add them here
    function populateCSS(){
        $('.overlay-content-wrapper').addClass('optprg-tdr-pop-up-1152-content');
        $('h3#overlay_lable').addClass('optprg-tdr-pop-up-heading');
        $('.splitter-column.columns.xlarge-6.large-6>.column-content>.richtext.initialized-richtextBEV.initialized-richtext>.richtext-content>h4').addClass('optprg-tdr-pop-up-price')
        $('.optprg-tdr-pop-up-price').append(`
        <span class="vehicle-attribute-group">
            <span class="vehicle-attribute-group">
                <span class="vehicle-attribute-group price-finalPrice-grossRetailWithOTRAndIncentives">
                    <h4 class="optprg-carname-tag">
                        <span class="optprg-carname">`+storedData_1152.carName+`</span>
                        <span class="optprg-subname">`+storedData_1152.subName+`</span>
                    </h4>
                    <h4 class="optprg-main-price-label" id="id-optprg-main-price-label">`+storedData_1152.retailPrice+`</h4>
                    <h4 class="optprg-offer-price">
                        
                    </h4>
                </span>
            </span>
        </span>`);
    
    
    }

    function compareLastClosed() {
        let popupState = JSON.parse(localStorage.getItem('popinState'));
        let current_timestamp = Math.floor(Date.now() / 1000);
        let last_closed_current = Math.floor(popupState.last_closed_time / 1000);
        var minuteDifference = (current_timestamp / 60) - (last_closed_current / 60);
        if (minuteDifference >= 15) {

            //It's been 15 days, clear LS
            if (minuteDifference >= 21600) {
                storePopinState(null, Number(0));
                return true;
            }

            if (popupState.alert_display_count < 3) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    }

    try {
        console.log('OT-1152');

        // Vehicle Info
        var storedData_1152 = {
            id: "${profile.id}",
            market: "${profile.market}",
            ticket: "${profile.ticket}",
            carName: "${profile.carName}",
            date: "${profile.date}",
            emissions: "${profile.emissions}" == "" ? "" : JSON.parse("${profile.emissions}".replace(/'/g, '"')),
            img: "${profile.img}",
            retailPrice: "${profile.retailPrice}",
            retailTitle: "${profile.retailTitle}",
            offerPrice: "${profile.offerPrice}",
            offerTitle: "${profile.offerTitle}",
            subName: "${profile.subName}",
            vehicleType: "${profile.vehicleType}",
            contextualiseLink: "${profile.contextualiseLink}",
            vehicleCode: "${profile.tdrVehicleCode}"
        }

        // Popup Data
        var popupData_1152 = {
            popup_last_closed: Number("${profile.nl.popup_last_closed}"),
            popup_display_count: Number("${profile.nl.popup_display_count}")
        };

        // Just in case data from a different Market gets through
        // Also checks if a vehicleCode is available, if it doesn't it won't display.
        var display_1152 = "NL" == storedData_1152.market && "OT-1152" == storedData_1152.ticket && !storedData_1152.contextualiseLink.toLowerCase().includes('undefined');

        // Remove on the home page
        var dislay_1152 = displayPopup(storedData_1152);

        if (display_1152) {

            /*if (storedData_1152.contextualiseLink.indexOf('bodystyle') > 0) {
                storedData_1152.contextualiseLink = storedData_1152.contextualiseLink.replace('bodystyle', 'colour');
            } else if (storedData_1152.contextualiseLink.indexOf('colour') > 0) {
                storedData_1152.contextualiseLink = storedData_1152.contextualiseLink.replace('colour', 'interior');
            } else if (storedData_1152.contextualiseLink.indexOf('interior') > 0) {
                storedData_1152.contextualiseLink = storedData_1152.contextualiseLink.replace('interior', 'extras');
            }*/



            $(document).ready(function () {

                function overrideLog(error) {
                    if (/targetDebug=1152/i.test(window.location.href)) {
                        console.log(error);
                    }

                    targetErrors.push({ ticket: "1152", error });
                }
                /**
                *
                *	DOM builder
                *	(requires jQuery)
                *
                * #def name DOMBuilder
                *
                *	SYNTAX:
                *	jQueryobject DOMbuilder(srcObject);
                *
                *	srcObject = DOMobject || [array of DOMobject] || jQueryObject || [array of jQueryObject] || function (returning srcObject);
                *
                *	DOMobject = {
                *		type: 'div',
                *		id: 'elm-id' || null,
                    render: boolean, // You can decide if element will be rendered
                *		className: 'elm-class' || 'elm-class-1 elm-class-2' || null,
                *		data: { key: key, value: value } || null,
                *		text: 'Text content' || null,
                *		html: 'HTML content' || null,		// if html provided, text is ignored
                *		child: srcObject || null
                *		handlers: { eventID: function, ... } || null,
                *		callback: function($element) || null
                *		} || [ array of DOMobj ]
                *
                */
                function DOMBuilder(obj) {
                    if (!obj) return;
                    if (Object.prototype.toString.call(obj)) {
                        var i, arr = [];
                        for (i = 0; i < obj.length; i++) {
                            (obj[i] instanceof $) ? arr.push(obj[i]) : arr.push(DOMBuilder(obj[i]));
                        }
                        return arr;
                    } else if (obj instanceof $) return obj;
                    else if ($.isFunction(obj)) return DOMBuilder(obj());
                    else {
                        if (!obj.type) return obj.html || obj.text || undefined;
                        if (obj.hasOwnProperty("render") && !obj.render)
                            return undefined;
                        var $e = $('<' + obj.type + '>');
                        if (obj.id) $e.prop('id', obj.id);
                        if (obj.className) $e.addClass(obj.className);
                        if ($.isPlainObject(obj.data) && obj.data.key) $e.data(obj.data.key, obj.data.value);
                        obj.html ? $e.html(obj.html) : $e.text(obj.text || '');
                        if (obj.child) $e.append(DOMBuilder(obj.child));
                        if ($.isPlainObject(obj.handlers)) {
                            for (var evName in obj.handlers) $e.on(evName, obj.handlers[evName]);
                        }
                        if ($.isPlainObject(obj.props)) {
                            for (var propName in obj.props) $e.prop(propName, obj.props[propName]);
                        }
                        if ($.isFunction(obj.callback)) obj.callback($e);
                        return $e;
                    }
                }

                /**
                * JS VARIANT "Challenger" - Create testdrive popin or similar approach to generate additional testdrive leads
                */

                $(document).ready(function () {
                    var Constructions = {};
                    var ENV = {
                        elements: {},
                        data: {}
                    };

                    // Configurations
                    /* Market configuration */

                    (function (environment) {
                        environment.MarketConfiguration = {
                            // Define overlay URL
                            overlay: "/overlay/content/overlays/target/acc-tdr",
                            // Define delay in ms before opening overlay
                            delayBeforeOpenOverlay: 10000,

                            // Panel with informations like CO2
                            carDataSelector: "#global-ux .summary-wrapper .vehicle-info-view .vehicle-data .vehicle-data-row",
                            // Selectors to disclaimers in summary page
                            disclaimersSelector: "#global-ux .disclosure-text > ul.disclosure-list",
                            // Selector to offer price (if exists)
                            offerPriceSelector: "#global-ux .vehicle-view-container .vehicle-view-content.left-content .vehicle-view-price .price-promotional-bnp",
                            // Selector to retail price (if exists)
                            retailPriceSelector: "#global-ux .vehicle-view-container .vehicle-view-content.left-content .vehicle-view-price .price-retail-with-otr",

                            // Determine which data will be grabed from summary page
                            summaryPageDataDestinations: [{
                                // Image of car
                                query: "#build-price-configurator > div.app-view > div > div:nth-child(5) > section > div.vehicle-view-container > div.vehicle-view-content.right-content > div > img",
                                prop: "src",
                                key: "img"
                            }, {
                                // Find a dealer link
                                query: "a[data-contextual-link=\"dealer-locator\"]",
                                prop: "href",
                                key: "findDealer"
                            }, {
                                // Car nameplate name
                                query: "#build-price-configurator > div.app-view > div > div:nth-child(5) > section > div.vehicle-view-container > div.vehicle-view-content.left-content > h3 > strong",
                                text: true,
                                key: "carName"
                            }]
                        };
                    }(ENV));

                    var MBOXName = "NL_BP_C_Popin";
                    var MBOXFallbackTimeout = 300;

                    var timer = setInterval(function () {

                        var thisOverlay = document.querySelector('.overlay');
                        if (thisOverlay.classList.contains('is-active')) {

                            overrideLog('run impression id');

                            //run impressions
                            adobe.target.trackEvent({
                                "mbox": MBOXName,
                                "params": {
                                    "open": "pop-up-open"
                                }
                            });

                            window.targetCampaign = window.targetCampaign || {
                                page: {
                                    campaignName: "tt:nwp:opt-1152:xt:ase:ngc-bpa-bpc"
                                }
                            }
                            _satellite.track("genericTestingImpressionIDWorkaround");

                            clearInterval(timer);
                        }
                    }, 200);

                    /* Define texts - easily move across markets */

                    function returnSupThree() {
                        return "<sup class='supThreeClick'><a style='text-decoration: unset'>3</a></sup>";
                    }

                    $(document).ready(function (environment) {

                        var translations = {
                            heading: "Je hebt jouw ideale <nameplate>  samengesteld, waarom hier stoppen?",
                            pricePrefix: "€",
                            priceSuffix: "",
                            retailpricePrefix: "",
                            retailpriceSuffix: "",
                            dutyFree: "",
                            priceValidText: "",

                            mainPriceLabel: "ACTIEPRIJS",
                            mainPriceLabelNoOfferPrice: "",

                            retailPriceLabel: "CONSUMENTEN(ADVIES)PRIJS",

                            priceTooltipHeading: "Belangrijke informatie",
                            bookTDRButton: "Boek een proefrit",

                            buttonURL: "https://www.ford.nl/handige-links/ik-wil/proefrit-aanvragen-pop-up",


                            retailDisclaimer: "",
                            retailKey: "",
                            retailLabel: "",

                            offerDisclaimer: "",
                            offerKey: "",
                            offerLabel: "",
                        };


                        environment.Localisation = {
                            formatDate: formatDate,
                            formatMoney: function (amount) {
                                return Number(Number(amount).toFixed(0)).toLocaleString().replace(/\,/gm, ".")
                            },
                            getTranslation: getTranslation,
                            updateTranslations: updateTranslations,
                            requiredLabelsExist: requiredLabelsExist
                        };

                        function isNull(obj) {
                            return obj == undefined || obj == null || obj == "";
                        }

                        function requiredLabelsExist() {
                            if (!isNull(storedData_1152.offerPrice))
                                if (isNull(getTranslation("offerLabel")))
                                    return false;

                            if (!isNull(storedData_1152.retailPrice))
                                if (isNull(getTranslation("retailLabel")))
                                    return false;

                            return true;
                        }


                        function getTranslation(key, replacements) {
                            var tr = translations[key];
                            if (!tr)
                                return;
                            if (replacements) {
                                $(Object.keys(replacements)).each(function (i, replace) {
                                    tr = tr.replace("<" + replace + ">", replacements[replace]);
                                });
                            }

                            overrideLog(key + ": " + tr);
                            return tr;
                        }

                        function updateTranslations(key, replacements) {
                            try {
                                if (replacements) {
                                    translations[key] = replacements;
                                }
                            } catch (e) {
                                // assume key doesn't exist.
                                overrideLog(e);
                            }

                        }

                        function formatDate(date) {
                            return date.getDate() + "/" + (date.getMonth() + 1) + "/" + date.getFullYear();
                        }
                    }(ENV));

                    var StorageHandler = {};
                    StorageHandler.cookie = "opt-gux-nl"; // opt-gux-MARKET ~ for countries with multiple locales, name it MARKET_LANG ~ Always lower case.
                    StorageHandler.getData = function () {
                        var current = JSON.parse(localStorage.getItem(StorageHandler.cookie));
                        if (current == null)
                            return [];
                        else
                            return current;
                    };
                    StorageHandler.saveData = function (key, data) {
                        var current = StorageHandler.getData();

                        var exists = StorageHandler.getSpecificData(key);

                        if (exists.length > 0) {
                            for (var i = 0; i < current.length; i++) {
                                if (current[i].key == key) {
                                    current[i].data = data;
                                }
                            }
                        } else {
                            current.push({ key, data });
                        }
                        localStorage.setItem(StorageHandler.cookie, JSON.stringify(current));
                    };
                    StorageHandler.getSpecificData = function (key) {
                        var current = StorageHandler.getData();
                        return current.filter(function (each) {
                            return each.key == key;
                        });
                    };


                    // Elements builder
                    function loadInfo() {
                        ENV.Localisation.updateTranslations("offerLabel", storedData_1152.offerTitle);
                        ENV.Localisation.updateTranslations("retailLabel", storedData_1152.retailTitle);
                        var key = "disclaimers_1152_" + storedData_1152.id;

                        var data = StorageHandler.getSpecificData(key);

                        if (data.length == 0) {
                            return;
                        }

                        var disclaimerObj = data[0].data;

                        for (var i = 0; i < disclaimerObj.length; i++) {
                            if (disclaimerObj[i].type == "Retail") {
                                ENV.Localisation.updateTranslations("retailDisclaimer", disclaimerObj[i].content);
                                ENV.Localisation.updateTranslations("retailKey", disclaimerObj[i].symbol);
                            } else if (disclaimerObj[i].type == "Offer") {
                                ENV.Localisation.updateTranslations("offerDisclaimer", disclaimerObj[i].content);
                                ENV.Localisation.updateTranslations("offerKey", disclaimerObj[i].symbol);
                            }
                        }
                    }
                    loadInfo();

                    /* Generate tooltip */
                    $(document).ready(function () {

                        var tooltipInstance;
                        var overlay;

                        function docGlobUXOnClick(event) {
                            if (event.target.id === "optprg-tdr-pop-up-price-tooltip" || $(event.target).parents("#optprg-tdr-pop-up-price-tooltip").length)
                                return;
                            event.preventDefault();
                            closeTooltip();
                        }
                        function onResizeOrScrollEvent() {
                            closeTooltip();
                        }
                        function closeTooltip(event) {
                            if (event)
                                event.preventDefault();
                            if (!tooltipInstance)
                                return;
                            overlay.unbind("mousedown", docGlobUXOnClick);
                            overlay.unbind("scroll", onResizeOrScrollEvent);
                            $(window).unbind("resize", onResizeOrScrollEvent);
                            tooltipInstance.remove();
                            tooltipInstance = undefined;
                        }
                        function tooltip(options, close) {
                            return DOMBuilder({
                                type: "div",
                                className: "gux-tooltip-overlay",
                                id: "optprg-tdr-pop-up-price-tooltip",
                                props: {
                                    tabindex: "0"
                                },
                                callback: function (element) {
                                    element.attr("style", "position: absolute; top: " + options.top + "px; left: " + options.left + "px;right: auto; bottom: " + (options.bottom == undefined ? "auto" : options.bottom + "px") + "; z-index: 10001;");
                                },
                                child: [{
                                    type: "h5",
                                    className: "gux-tooltip-overlay-title",
                                    text: options.title
                                }, {
                                    type: "span",
                                    className: "gux-tooltip-overlay-text",
                                    child: [{
                                        type: "span",
                                        render: options.number ? true : false,
                                        text: options.number
                                    }, {
                                        type: "p",
                                        html: options.text
                                    }]
                                }, {
                                    type: "a",
                                    className: "close-icon",
                                    handlers: {
                                        click: close
                                    },
                                    props: {
                                        tabindex: "0"
                                    }
                                }]
                            });
                        }
                        Constructions.openTooltip = function (options) {
                            closeTooltip();

                            tooltipInstance = tooltip(options, closeTooltip);
                            document.querySelector("#global-ux").append(tooltipInstance);
                            if (!overlay)
                                overlay = options.overlay.parent();
                            overlay.on("mousedown", docGlobUXOnClick);
                            overlay.on("scroll", onResizeOrScrollEvent);
                            $(window).on("resize", onResizeOrScrollEvent);
                        };
                    }());

                    /* Component for show easily price - !this file has connection to tooltip definition */

                    Constructions.getPrice = function (options) {
                        return DOMBuilder({
                            type: "span",
                            child: [{
                                type: "span",
                                className: "vehicle-attribute-group price-finalPrice-grossRetailWithOTRAndIncentives",
                                child: [{
                                    type: "p",
                                    className: "optprg-carname",
                                    text: options.carName,
                                    child: [{
                                        type: "span",
                                        className: "optprg-subname",
                                        //text: options.subName
                                        html: options.subName
                                    }]
                                },
                                {
                                    type: "p",
                                    className: "optprg-main-price-label",
                                    text: options.recPrice,
                                    id: "id-optprg-main-price-label"
                                }, {
                                    type: "span",
                                    className: "optprg-vehicle-attribute-prefix",
                                    text: ENV.Localisation.getTranslation(options.pricePrefixName)
                                }, {
                                    type: "span",
                                    className: "value optprg-main-price-value",
                                    text: options.price
                                }, {
                                    type: "span",
                                    className: "duty-free",
                                    text: options.dutyPrice
                                }, {
                                    type: "span",
                                    className: "optprg-vehicle-attribute-suffix",
                                    text: ENV.Localisation.getTranslation(options.priceSuffixName)
                                }
                                ]
                            }, {
                                type: "sup",
                                className: "optprg-sup",
                                render: options.text ? true : false,
                                props: {
                                    href: "#"
                                },
                                child: [{
                                    type: "a",
                                    className: "optprg-a",
                                    text: options.number,
                                    handlers: {
                                        click: function (e) {
                                            e.preventDefault();
                                            var position = document.querySelector(this).offset();
                                            var size = {
                                                w: document.querySelector(this).width(),
                                                h: document.querySelector(this).height()
                                            };
                                            Constructions.openTooltip({
                                                top: position.top + size.h,
                                                left: position.left + size.w,
                                                title: options.heading,
                                                text: options.text,
                                                number: options.number,
                                                overlay: options.overlay
                                            });
                                        }
                                    }
                                }]
                            }]
                        });
                    };


                    // Handlers
                    /* Handle close events */

                    function initializeCloseHandlers(overlay) {
                        function destroy() {
                            $(document).unbind("keydown", onKeyPress);
                            destroyOverlay();
                        }
                        function destroyOverlay() {
                            var content = $('.optprg-tdr-pop-up-1152-content'); // Replace 1041 to match the ticket you're on.
                            if (content.length > 0) {
                                var contentParent = content[0].parentElement;
                                if (!isNull(contentParent) && contentParent.classList.value.includes('overlay-container')) {
                                    contentParent.remove();
                                }
                            }
                        }
                        var handlers = {
                            dontShowAgainClose: function (wayOfDestroy, callback, mbox) {
                                adobe.target.trackEvent({
                                    mbox: mbox,
                                    params: {
                                        release: wayOfDestroy,
                                        popup: wayOfDestroy
                                    },
                                    success: function () {
                                        if (callback)
                                            callback();
                                    },
                                    error: function () {
                                        if (callback)
                                            callback();
                                    }
                                });
                                if (callback)
                                    setTimeout(function () {
                                        callback();
                                    }, MBOXFallbackTimeout);
                                destroy();
                            },
                            showAgainClose: function (wayOfDestroy, mbox) {
                                adobe.target.trackEvent({
                                    mbox: mbox,
                                    params: {
                                        popup: wayOfDestroy
                                    }
                                });
                                destroy();
                            }
                        };
                        function onKeyPress(e) {
                            if (e.keyCode == 27) {

                                let cPopinState = JSON.parse(localStorage.getItem('popinState'));
                                let num = Number(cPopinState.alert_display_count + 1);
                                handlers.dontShowAgainClose("close_escape_keyboard", storePopinState(Math.floor(Date.now()), num), "NL_1152_close_cta_ctr");
                            }
                        }

                        document.addEventListener('keydown', function (e) {
                            onKeyPress(e);
                        });

                        var divOverlayClose = document.querySelector('span.overlay-close-button');
                        divOverlayClose.addEventListener('click', function (e) {

                            let cPopinState = JSON.parse(localStorage.getItem('popinState'));
                            let num = Number(cPopinState.alert_display_count + 1);
                            handlers.dontShowAgainClose("clicked_x", storePopinState(Math.floor(Date.now()), num), "NL_1152_close_cta_ctr");
                        });
                        var divOverlayParent = document.querySelector('.overlay').parentNode;

                        var elementWrapper = document.querySelector('.overlay-content-wrapper');

                        divOverlayParent.addEventListener('click', function (e) {
                            if (event.target.classList.contains('.overlay-content-wrapper')) {

                                let cPopinState = JSON.parse(localStorage.getItem('popinState'));
                                let num = Number(cPopinState.alert_display_count + 1);
                                handlers.showAgainClose("clicked_outside_overlay", storePopinState(Math.floor(Date.now()), num), "NL_1152_close_cta_ctr");
                            }
                        });
                        return handlers;
                    }

                    function updatePopupData(popup_last_closed, popup_display_count) {
                        adobe.target.getOffer({
                            'mbox': 'global-mbox',
                            'params': {
                                'profile.nl.popup_last_closed': popup_last_closed,
                                'profile.nl.popup_display_count': popup_display_count
                            },
                            'success': function (offer) {
                                adobe.target.applyOffer({
                                    'mbox': 'global-mbox',
                                    'offer': offer
                                });
                            },
                            'error': function (status, error) {
                                console.log('Error', status, error);
                            }
                        });
                    }

                    var Popup = {};
                    Popup.isPopupOpen = false;
                    Popup.showPopupAfter = 900; // IN SECONDS - 900 SECONDS WHICH IS 15 MINUTES
                    Popup.openThreshold = 2; // LIMIT THE AMOUNT OF TIMES THE POPUP OPENS
                    Popup.currentTimeStamp = Math.floor(Date.now() / 1000);
                    Popup.setLastClosed = function () {
                        Popup.setKeyValue("popup_last_closed", Math.floor(Date.now() / 1000));
                    };

                    Popup.determineIfPopupShows = function () {

                        if (!ENV.Localisation.requiredLabelsExist()) {
                            overrideLog("Price labels, not populated");
                            return false;
                        }

                        if (compareLastClosed() === false) {
                            return false;
                        }

                        return (compareLastClosed()) || /targetDebug=1152/i.test(window.location.href);


                    };
                    Popup.setKeyValue = function (key, value) {

                        popupData_1152[key] = value;

                        updatePopupData(popupData_1152.popup_last_closed, popupData_1152.popup_display_count)
                    };

                    /* Open TDR Overlay */
                    var OverlayHelpers = {};

                    $(document).ready(function () {
                        if (localStorage.getItem('popinState') === undefined || localStorage.getItem('popinState') === null) {
                            storePopinState(null, Number(0));
                        }
                        var isAlreadyOpenCalled = false;

                        OverlayHelpers.openOverlay = function (overlay, onOverlayOpen) {
                            if (compareLastClosed() === false) {
                                return false;
                            }

                            // create overlay anchor tag
                            var overlayLink = document.createElement('a');
                            overlayLink.className = "link-overlay popin-1152 acc-pd-overlay initialized-overlay initialized-bevLinkOverlay"
                            "link-overlay popin-1152 acc-pd-overlay initialized-overlay initialized-bevLinkOverlay";
                            overlayLink.href = "/overlay/content/overlays/target/acc-tdr";
                            overlayLink.setAttribute("role", "button");
                            overlayLink.innerText = "POPIN OT-1152";
                            document.body.appendChild(overlayLink);

                            var element = document.querySelector(".popin-1152");

                            function waitForOverlayOpen(overlay) {
                                if (!accOverlay.default.$overlay[0])
                                    return setTimeout(function () {
                                        waitForOverlayOpen(overlay);
                                    }, 50);
                                onOverlayOpen(overlay);
                            }

                            element.addEventListener('click', function (e) {
                                e.preventDefault();
                            });

                            var overlay = accOverlay.default.init(element);

                            element.click();

                            if (!popupData_1152) {

                                overrideLog('1. popupData_1152');

                                updatePopupData(0, 1);
                                Popup.setLastClosed();

                                var overlay = accOverlay.default.init(element);
                                overrideLog("Trigger Popup");
                                let popupState = JSON.parse(localStorage.getItem('popinState'));
                                //overlay.getOverlayContent('/overlay/content/overlays/target/tdr');
                                waitForOverlayOpen(overlay);
                                Popup.isPopupOpen = true;
                            }
                            else {

                                if (Popup.determineIfPopupShows()) {
                                    console.log(popupData_1152.popup_display_count, popupData_1152.popup_last_closed);
                                    let popupState = JSON.parse(localStorage.getItem('popinState'));
                                    var overlay = accOverlay.default.init(element);
                                    overrideLog("Trigger Popup");
                                    //overlay.getOverlayContent('/overlay/content/overlays/target/tdr');
                                    waitForOverlayOpen(overlay);

                                    overrideLog('2. here');

                                }
                            }
                            element.remove();
                        };

                        /* Fill overlay with data */
                        OverlayHelpers.fillOverlay = function (overlay, data, closeHandlers, limit) {
                            ENV.overlayInstance = accOverlay.default.instances[7];
                            var overlayContent = accOverlay.default.$overlay[0];

                            overlayContent.id = "global-ux";

                            var image = overlayContent.querySelector("img.picture-tag-fallback");

                            if (limit >= 100)
                                return false;

                            if ($('.splitter-column.columns.xlarge-6.large-6>.column-content>.image>.component-content>picture>img').length === 0 || image === null || image === undefined)
                                return setTimeout(function () {
                                    OverlayHelpers.fillOverlay(overlay, data, closeHandlers, limit ? limit++ : 1);
                                }, 40);

                            locateAllElements(overlayContent, image, data.offerPrice ? true : false);
                            fillFinishedBnPOverlay(data, closeHandlers);

                        };

                        function locateAllElements(overlayContent, image, hasOfferPrice) {
                            ENV.elements.overlayContentWrapper = overlayContent.querySelector('.overlay-content-wrapper');
                            ENV.elements.overlayContentWrapper.classList.add("optprg-tdr-pop-up-1152-content");

                            ENV.elements.image = image.classList.add("optprg-tdr-pop-up-image");
                            ENV.elements.heading = overlayContent.querySelector("h3").classList.add("optprg-tdr-pop-up-heading");
                            ENV.elements.offerPrice = overlayContent.querySelector("h4").classList.add("optprg-tdr-pop-up-price");

                            var elemPrice = overlayContent.querySelector(".optprg-tdr-pop-up-price");
                            elemPrice.innerHTML = "";
                            var clonedPrice = elemPrice.cloneNode(true);
                            //clonedPrice[0].outerHTML = clonedPrice[0].outerHTML.replaceAll("h4", "h5");

                            ENV.elements.retailPrice = elemPrice.parentNode.insertBefore(clonedPrice, elemPrice.nextSibling);
                            // ENV.elements.retailPrice = ENV.elements.offerPrice.after(clonedPrice).next();
                            ENV.elements.retailPrice.outerHTML = ENV.elements.retailPrice.outerHTML.replaceAll('h4', 'h5');
                            ENV.elements.retailPrice = overlayContent.querySelector("h5");

                            var vehicleAttrContainer = document.createElement('span');
                            // Add class and HTML content
                            vehicleAttrContainer.className = 'vehicle-attribute-group';
                            vehicleAttrContainer.innerHTML =
                                '<span class="vehicle-attribute-group price-finalPrice-grossRetailWithOTRAndIncentives"> ' +
                                '<p class="optprg-carname-tag"><span class = "optprg-carname"> </span> <span class="optprg-subname"> </span> </p>' +
                                '<p class="optprg-main-price-label" id="id-optprg-main-price-label"> </p>' +
                                '<span class="optprg-vehicle-attribute-prefix"> </span>' +
                                '<span class="value optprg-main-price-value" </span>' +
                                '<span class="duty-free" </span>' +
                                '<span class="optprg-vehicle-attribute-suffix" </span></span>' +
                                '<sup class="optprg-sup" href="#"> <a class="optprg-a"> </a>';

                            elemPrice.appendChild(vehicleAttrContainer, elemPrice);

                            var nextVehicleAttrContainer = document.createElement('span');

                            nextVehicleAttrContainer.className = "optprg-retail-price-box";
                            nextVehicleAttrContainer.innerHTML =
                                '<span class="vehicle-attribute-group price-finalPrice-grossRetailWithOTRAndIncentives"></span>' +
                                '<p class="optprg-carname"><span class="optprg-subname"></span></p>' +
                                '<p class="optprg-main-price-label" id="id-optprg-main-price-label"> </p>' +
                                '<span class="optprg-vehicle-attribute-prefix"> </span>' +
                                '<span class="value optprg-main-price-value" </span>' +
                                '<span class="duty-free" </span>' +
                                '<span class="optprg-vehicle-attribute-suffix" </span>' +
                                '<sup class="optprg-sup" href="#"> <a class="optprg-a" </a>';

                            ENV.elements.retailPrice.appendChild(nextVehicleAttrContainer, ENV.elements.retailPrice);


                            ENV.elements.secondaryButton = overlayContent.querySelector("a.cta-button.cta-button-secondary");
                            ENV.elements.primaryButton = overlayContent.querySelector("a.cta-button.cta-button-primary");



                            ENV.elements.horsTaxe = document.createElement('p');
                            ENV.elements.horsTaxe.className = 'hors-taxe';
                            ENV.elements.retailPrice.parentNode.insertBefore(ENV.elements.horsTaxe, ENV.elements.retailPrice.nextSibling);

                            ENV.elements.priceInformation = document.createElement('p');
                            ENV.elements.priceInformation.className = 'optprg-price-info';
                            ENV.elements.primaryButton.parentNode.insertBefore(ENV.elements.priceInformation, ENV.elements.primaryButton.nextSibling);

                            ENV.elements.co2Information = document.createElement('p');
                            ENV.elements.co2Information.className = 'optprg-co2-info';
                            ENV.elements.priceInformation.parentNode.insertBefore(ENV.elements.co2Information, ENV.elements.priceInformation.nextSibling);
                            ENV.elements.co2Information = $('.optprg-co2-info');
                        }

                        function fillFinishedBnPOverlay(data, closeHandlers) {

                            try {
                                var i = 0;
                                ENV.elements.heading = document.querySelector("h3.optprg-tdr-pop-up-heading");
                                ENV.elements.priceInformation = document.querySelector("p.optprg-price-info");
                                ENV.elements.offerPrice = $(".vehicle-attribute-group h4.optprg-tdr-pop-up-price");
                                ENV.elements.pricePrefix = document.querySelector(".vehicle-attribute-group span.optprg-vehicle-attribute-prefix");
                                ENV.elements.carName = document.querySelector(".vehicle-attribute-group .optprg-carname");
                                ENV.elements.subName = document.querySelector(".vehicle-attribute-group span.optprg-subname");
                                ENV.elements.price = document.querySelector(".vehicle-attribute-group .optprg-main-price-value");
                                ENV.elements.recPrice = document.querySelector(".vehicle-attribute-group .optprg-main-price-label");
                                //ENV.elements.text = document.querySelector()

                                ENV.elements.horsTaxe = document.querySelector(".hors-taxe");
                                ENV.elements.dutyFree = document.querySelector(".duty-free");



                                // RETAIL
                                ENV.elements.retailPricePrefix = document.querySelector(".optprg-retail-price-box span.optprg-vehicle-attribute-prefix");
                                ENV.elements.retailpriceSuffixName = document.querySelector(".optprg-retail-price-box .optprg-vehicle-attribute-suffix");
                                ENV.elements.retailcarName = document.querySelector(".optprg-retail-price-box .optprg-carname");
                                ENV.elements.retailsubName = document.querySelector(".optprg-retail-price-box .optprg-subname");
                                ENV.elements.retailPrice = $(".optprg-retail-price-box");
                                ENV.elements.retailPriceValue = document.querySelector(".optprg-retail-price-box .optprg-main-price-value");
                                ENV.elements.retailPriceLabel = document.querySelector(".optprg-retail-price-box  .optprg-main-price-label");



                                ENV.elements.heading.innerHTML = ENV.Localisation.getTranslation("heading").replace("<nameplate>", data.carName + ' ' + data.subName);
                                //ENV.elements.heading.html(ENV.Localisation.getTranslation("heading").replace("<nameplate>", data.carName + ' ' + data.subName));

                                var imgNodelist = document.querySelectorAll('div.image.section > div.component-content source');
                                var i = 0;
                                for (; i < imgNodelist.length; i++) {
                                    imgNodelist[i].remove();
                                }

                                ENV.elements.popinVehicleImage = document.querySelector('.optprg-tdr-pop-up-image');
                                ENV.elements.popinVehicleImage.src = data.img;


                                //ENV.elements.secondaryButton.remove();

                                ENV.elements.primaryButton.href = ENV.Localisation.getTranslation("buttonURL") + data.vehicleCode;
                                ENV.elements.primaryButton.innerHTML = ENV.Localisation.getTranslation("bookTDRButton");
                                ENV.elements.primaryButton.removeAttribute("data-cta-name");
                                ENV.elements.primaryButton.classList.add("optprg-primary-button");

                                ENV.elements.primaryButton.addEventListener('click', function (e) {

                                    closeHandlers.dontShowAgainClose("clicked_TDR_CTA", function () {

                                        adobe.target.trackEvent({
                                            "mbox": MBOXName,
                                            "params": {
                                                "linkClicked": "true"
                                            }
                                        });

                                        window.addEventListener('load', function () {
                                            _satellite.track("impression-xt-popin")
                                        });

                                        ENV.overlayInstance.hideOverlay();
                                    }, "NL_1152_main_cta_ctr");

                                });

                                // MachE being the only vehicle with a visible price.

                                if (!storedData_1152.retailPrice) {
                                    overrideLog('Hide Retail Price');
                                    ENV.elements.retailPrice.hide();
                                }
                                else {
                                    overrideLog('2. Got here');

                                    // ENV.elements.retailPrice.html(Constructions.getPrice({
                                    //     pricePrefixName: "pricePrefix",
                                    //     priceSuffixName: "priceSuffix",
                                    //     carName: data.carName,
                                    //     subName: " " + data.subName,
                                    //     price:  ENV.Localisation.formatMoney(data.retailPrice),
                                    //     recPrice: ENV.Localisation.getTranslation("retailLabel"),
                                    //     text: ENV.Localisation.getTranslation("retailDisclaimer"),
                                    //     number: ENV.Localisation.getTranslation("retailKey"),
                                    //     heading: ENV.Localisation.getTranslation("priceTooltipHeading"),
                                    //     overlay: ENV.elements.overlayContent
                                    // }));

                                    ENV.elements.retailPricePrefix.innerHTML = ENV.Localisation.getTranslation("pricePrefix");
                                    ENV.elements.retailpriceSuffixName.innerHTML = ENV.Localisation.getTranslation("priceSuffix");
                                    ENV.elements.retailcarName.innerHTML = !data.offerPrice ? data.carName + " " : "";
                                    ENV.elements.retailsubName.innerHTML = !data.offerPrice ? data.subName : "";
                                    ENV.elements.retailPriceValue.innerHTML = ENV.Localisation.formatMoney(data.retailPrice);
                                    ENV.elements.retailPriceLabel.innerHTML = ENV.Localisation.getTranslation("retailLabel");
                                }

                                if (!storedData_1152.offerPrice) {
                                    overrideLog('Hide Offer Price');

                                    ENV.elements.offerPrice.hide();
                                }
                                else {
                                    overrideLog('1. Got here');

                                    // ENV.elements.offerPrice.html(Constructions.getPrice({
                                    //     pricePrefixName: "pricePrefix",
                                    //     priceSuffixName: "priceSuffix",
                                    //     carName: data.carName,
                                    //     subName: " " + data.subName,
                                    //     price:  ENV.Localisation.formatMoney(data.retailPrice),
                                    //     recPrice: ENV.Localisation.getTranslation("offerLabel"),
                                    //     text: ENV.Localisation.getTranslation("offerDisclaimer"),
                                    //     number: ENV.Localisation.getTranslation("offerKey"),
                                    //     heading: ENV.Localisation.getTranslation("priceTooltipHeading"),
                                    //     overlay: ENV.elements.overlayContent
                                    // }));

                                    ENV.elements.priceInformation.innerHTML = ENV.Localisation.getTranslation("priceValidText");

                                    ENV.elements.pricePrefix.innerHTML = ENV.Localisation.getTranslation("pricePrefix");
                                    ENV.elements.carName.innerHTML = data.carName;
                                    ENV.elements.subName.innerHTML = data.subName;
                                    ENV.elements.price.innerHTML = ENV.Localisation.formatMoney(data.offerPrice);
                                    ENV.elements.recPrice.innerHTML = ENV.Localisation.getTranslation("offerLabel");
                                }



                                // if (data.vehicleType == "CV") {
                                //     overrideLog('commercial vehicle');
                                //     ENV.elements.carName.innerHTML = storedData_1152.carName;
                                //     ENV.elements.subName.innerHTML = storedData_1152.subName
                                //     ENV.elements.horsTaxe.innerHTML('Hors Taxe');
                                //     ENV.elements.recPrice.innerHTML('À partir de');
                                //     // $('.optprg-main-price-label').css("font-size", '1.8rem');
                                //     // $('.hors-taxe').css("font-size", '12px');
                                //     ENV.elements.dutyFree.show();
                                //     ENV.elements.price.hide();
                                //     ENV.elements.retailPrice.hide();
                                //     overrideLog(storedData.carName);
                                // } else {
                                //     overrideLog('not commercial vehicle');
                                //     ENV.elements.dutyFree.display = 'none';
                                //     ENV.elements.recPrice.style.display = 'none';
                                //     ENV.elements.retailPriceLabel.style.display = 'none';
                                // }

                                overrideLog(data.tdr);
                                overrideLog(data.tdrVehicleCode);


                                //ENV.elements.afterPrices.hide();
                                var emissions = data.emissions.co ? getValueUnit(data.emissions.co) : { unit: "", value: "" };
                                var litersToUnit = data.emissions.lToKm ? getValueUnit(data.emissions.lToKm) : { unit: "", value: "" };
                                var hybridInfo = data.emissions.kwToKm ? getValueUnit(data.emissions.kwToKm) : { unit: "", value: "" };

                                overrideLog(emissions);
                                overrideLog(litersToUnit);
                                overrideLog(hybridInfo);

                                litersToUnit.unit = litersToUnit.unit.toLowerCase();
                                litersToUnit.value = litersToUnit.value.replace('.', ',');
                                emissions.value = emissions.value.replace('.', ',');
                                hybridInfo.value = hybridInfo.value == "" ? "" : (
                                    hybridInfo.value < 100 ? hybridInfo.value.replace('.', ',') : (
                                        ((hybridInfo.value / 10) + "").replace('.', ',')
                                    )
                                )

                                var line_fuelConsumption = litersToUnit.value != "" ? ENV.Localisation.getTranslation("fuelConsumption", {
                                    ltValue: litersToUnit.value,
                                    ltUnit: litersToUnit.unit
                                }) : "",
                                    line_co2Information = emissions.value != "" ? ENV.Localisation.getTranslation("co2Information", {
                                        coValue: emissions.value,
                                        coUnit: emissions.unit
                                    }) : "",
                                    line_electricConsumption = hybridInfo.value != "" ? ENV.Localisation.getTranslation("electricConsumption", {
                                        kwValue: hybridInfo.value
                                    }) : "";

                                if (line_fuelConsumption || line_co2Information || line_electricConsumption) {
                                    ENV.elements.co2Information.html(
                                        line_fuelConsumption + line_electricConsumption + line_co2Information
                                    );

                                    var overlayForSup = document.querySelector('.optprg-tdr-pop-up-1152-content');
                                    var sups = overlayForSup.querySelectorAll('.supThreeClick');

                                    var title = ENV.Localisation.getTranslation('priceTooltipHeading');
                                    var text = ENV.Localisation.getTranslation('disclaimer3');

                                    for (var i = 0; i < document.getElementsByClassName('supThreeClick').length; i++) {
                                        sups[i].onclick = function (e) {
                                            try {
                                                e.preventDefault();
                                                var position = document.querySelector(this).offset();
                                                var size = {
                                                    w: document.querySelector(this).width(),
                                                    h: document.querySelector(this).height()
                                                };
                                                Constructions.openTooltip({
                                                    top: position.top + size.h,
                                                    left: position.left + size.w,
                                                    bottom: 0,
                                                    title: title,
                                                    text: text,
                                                    number: '3',
                                                    overlay: overlayForSup
                                                });
                                            } catch (E) {
                                                overrideLog(E);
                                            }
                                        }
                                    }
                                } else {
                                    overrideLog('hidden emissions');
                                    ENV.elements.co2Information.hide();
                                }



                            } catch (ex) {
                                overrideLog(ex);
                            }
                        }
                        function getValueUnit(map) {
                            if (map.value != undefined)
                                return map;
                            var units = Object.keys(map);
                            if (!units.length)
                                return null;
                            return {
                                unit: map[units[0]].unit,
                                value: map[units[0]].value
                            };
                        }
                    }());

                    if (!display_1152 || !storedData_1152.img || !storedData_1152.carName || !storedData_1152.contextualiseLink)
                        return;

                    var Popupdetection = {};
                    Popupdetection.getCookie = function (name) {
                        var cookie = " " + document.cookie;
                        var search = " " + name + "=";
                        var setStr = null;
                        var offset = 0;
                        var end = 0;
                        if (cookie.length > 0) {
                            offset = cookie.indexOf(search);
                            if (offset != -1) {
                                offset += search.length;
                                end = cookie.indexOf(";", offset)
                                if (end == -1) {
                                    end = cookie.length;
                                }
                                setStr = unescape(cookie.substring(offset, end));
                            }
                        }
                        return (setStr);
                    };

                    function containsSophus() {
                        if (typeof s3_creativeDisplayed === "undefined" && (typeof s3_creativeDisplayed !== "object" || !s3_creativeDisplayed))
                            return false;
                        if (s3_creativeDisplayed)
                            return true;
                        return false;
                    }

                    // function containsBrazePopUp() {
                    //     var root = document.querySelector('.ab-iam-root');
                    //     if (Object.keys(root).length > 0)
                    //         return true;
                    //     else
                    //         return false;
                    // }

                    function getCookieNameContains(nameIncludes) {
                        var allCookies = document.cookie;
                        if (allCookies.length > 0) {
                            var cookieArray = allCookies.split(';');
                            for (var i = 0; i < cookieArray.length; i++) {
                                var name = cookieArray[i].split('=')[0];
                                if (name.includes(nameIncludes))
                                    return true;
                            }
                        }
                        return false;
                    }

                    function blockPopup() {
                        if (window.location.href.indexOf('?td=1152') > 0) {
                            return false;
                        }
                        if ((getCookieNameContains('IPE') || getCookieNameContains('IPE_M_')) || containsSophus() || compareLastClosed() === false) {
                            overrideLog('blocked');
                            return true;
                        }

                        return false;
                    }

                    if (blockPopup())
                        return;

                    setTimeout(function () {

                        if (!blockPopup()) {
                            OverlayHelpers.openOverlay(ENV.MarketConfiguration.overlay, function (overlay) {

                                OverlayHelpers.fillOverlay(overlay, storedData_1152, initializeCloseHandlers(accOverlay.default.$overlay[0]));

                                adobe.target.trackEvent({
                                    "mbox": MBOXName,
                                    "params": {
                                        "open": "pop-up-open"
                                    }
                                });

                                window.targetCampaign = {
                                    page: {
                                        campaignName: "tt:nwp:opt-1152:xt:ase:ngc-bpa-bpc"
                                    }
                                }

                                _satellite.track("impression-xt-popin")
                                //Add this to do a 'click'
                                $('#gux3').click();


                            });
                        }
                    }, ENV.MarketConfiguration.delayBeforeOpenOverlay);
                });
            }());

            window.addEventListener('load', function () {
                var objToHide = document.querySelectorAll('.optprg-carname')[1];
                if (objToHide != undefined) {
                    objToHide.style.display = 'none';
                }

            });

            window.addEventListener('click', function () {
                try {
                    console.log('This is to force it to stop firing');
                    console.dir(window.targetCampaign);
                    window.targetCampaign.page.campaignName = "";
                    console.log('name is ' + window.targetCampaign.page.campaignName)
                } catch (ex) {
                    console.log('Ex is');
                    console.dir(ex);
                }
            });
        }
    } catch (ex) {
        console.info("new solution required");
        targetErrors.push({ ticket: "1152", error });
    }

</script>
<!--
<style>
    /*

        ------------------------
        |       NOTE           |
        ------------------------
        These aren't currently in the build
        adding the styling here so when it is added
        we can get the css here.

        UPE $48,500 Retail Price
        Desktop/Tablet:

        font-family: FordAntennaRegular;
        font-size: 16px;
        font-weight: normal;
        font-stretch: normal;
        font-style: normal;
        line-height:1.63;
        letter-spacing: 1px;
        color: #4d4d4d;

        Disclaimer text below button
        Desktop/Tablet:

        width: 428px;
        height: 63px;
        font-family: FordAntennaRegular;
        font-size: 12px;
        font-weight: normal;
        font-stretch: normal;
        font-style: normal;
        line-height: 1.75;
        letter-spacing: 1px;
        color: #4d4d4d;

    */
    @media only screen and (min-width: 992px) {
        #global-ux .optprg-tdr-pop-up-1152-content .splitter { 
            padding: 10px 6.59% 50px;
        }

        #global-ux .overlay-content.optprg-tdr-pop-up-1152-content {
            max-width: 1035px;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .splitter-column-wrap>.splitter-column:last-child {
            padding-left: 55px !important;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .image.section {
            width: 393px;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-tdr-pop-up-heading {
            font-size: 34px;
            font-weight: 300 !important;
            line-height: 1.29 !important;
            letter-spacing: 4px;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-carname {
            letter-spacing: 3px;
            font-size: 24px !important;
            line-height: 1.42 !important;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-subname {
            font-size: 24px !important;
        }

        #global-ux .optprg-tdr-pop-up-1152-content #id-optprg-main-price-label {
            display: block !important;
            font-size: 16px;
            line-height: 1.63;
            letter-spacing: 1px;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-primary-button {
            height: 40px;
            font-size: 14px !important;
            line-height: 0.72;
            letter-spacing: 1px;
            padding: 13px 25px 13px 25px !important;
        }
    }

    #global-ux .optprg-tdr-pop-up-1152-content .icon-x,
    #optprg-tdr-pop-up-price-tooltip .close-icon:before {
        color: #102b4e !important;
    }

    #optprg-tdr-pop-up-price-tooltip .gux-tooltip-overlay-title {
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
        margin: 0px;
        font-weight: 300;
        font-size: 1.125rem;
        line-height: 1.39;
        letter-spacing: 4px;
        color: #4d4d4d;
    }

    #optprg-tdr-pop-up-price-tooltip .gux-tooltip-overlay-text {
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
        font-weight: 200;
        font-size: 18px;
        line-height: 1.333;
        letter-spacing: .015em;
        margin: 0px;
    }

    #optprg-tdr-pop-up-price-tooltip .gux-tooltip-overlay-text>span {
        color: #4d4d4d !important;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-tdr-pop-up-heading {
        text-align: center;
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
        font-stretch: normal;
        font-style: normal;
        color: #4d4d4d !important;
    }

    #global-ux #id-optprg-main-price-label {
        display: block !important;
        font-weight: normal;
        font-stretch: normal;
        font-style: normal;
        color: #4d4d4d;
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-info,
    #global-ux .optprg-tdr-pop-up-1152-content .optprg-co2-info,
    #global-ux .optprg-tdr-pop-up-1152-content .optprg-price-info {
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
        font-weight: normal !important;
        font-stretch: normal;
        font-style: normal;
        letter-spacing: 1px;
        color: #4d4d4d !important;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-sup {
        font-size: 50%;
        top: -1em;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-a {
        text-decoration: unset;
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
        left: auto;
        vertical-align: super;
        font-size: 0.5625rem;
        cursor: pointer;
        background: none;
        border-width: initial;
        border-style: none;
        border-color: initial;
        border-image: initial;
        margin-top: 10px;
        color: #4d4d4d;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-main-price-value {
        font-weight: 500;
        font-stretch: normal;
        font-style: normal;
        color: #4d4d4d;
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;

        font-size: 24px !important;
        line-height: 1.42;
        letter-spacing: 3px;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-primary-button {
        border-radius: 20px;
        color: #FFF !important;
        background-color: #102b4e !important;
        border-color: unset !important;
        font-weight: normal !important;
        font-stretch: normal;
        font-style: normal;
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
        margin-bottom: 19px !important;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-primary-button:hover {
        background-color: rgb(40, 97, 164) !important;
        color: rgb(255, 255, 255) !important;
        box-shadow: rgba(0, 0, 0, 0.1) 0px 10px 10px 0px, rgba(0, 0, 0, 0.1) 0px 20px 20px 0px, rgba(0, 0, 0, 0.15) 0px 30px 30px 0px !important;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-carname {
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
        font-weight: bold !important;
        font-stretch: normal;
        font-style: normal;
        color: #4d4d4d !important;
    }

    #global-ux .optprg-tdr-pop-up-1152-content p.hors-taxe {
        font-size: 12px;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .cta-button.cta-button-primary {
        margin-bottom: 2rem;
        font-size: .9rem
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-vehicle-attribute-prefix,
    #global-ux .optprg-tdr-pop-up-1152-content .optprg-vehicle-attribute-suffix {
        font-size: 24px;
        font-weight: 200
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-info,
    #global-ux .optprg-tdr-pop-up-1152-content .optprg-co2-info,
    #global-ux .optprg-tdr-pop-up-1152-content .optprg-price-info {
        font-size: 12px !important;
        margin: 0 !important;
        padding: 0 !important
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-tdr-pop-up-price,
    #global-ux .optprg-tdr-pop-up-1152-content .optprg-retail-price-box {
        font-size: 24px !important;
        padding: 0 !important;
        margin: 0 !important;
        border: none !important
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-tdr-pop-up-price span,
    #global-ux .optprg-tdr-pop-up-1152-content .optprg-retail-price-box span {
        font-size: 24px;
        /* font-size: 1.8rem !important */
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-retail-price-box.optprg-include-offer {
        margin-top: -12px !important;
        font-weight: normal !important;
        font-stretch: normal !important;
        font-style: normal !important;
        color: #4d4d4d !important;

        font-size: 16px !important;
        line-height: 1.63;
        letter-spacing: 1px;
    }

    #global-ux .optprg-tdr-pop-up-1152-content .optprg-retail-price-box.optprg-include-offer span {
        font-size: .75rem !important;
        font-weight: 300 !important;
        letter-spacing: 1px !important;
    }

    #global-ux .optprg-tdr-pop-up-1152-content p.optprg-main-price-label {
        font-size: .75rem;
        display: block;
        padding: 0;
        margin: 0
    }

    /* TABLET */
    @media only screen and (max-width:61.9375em) { /* (min-width:48em) and (max-width:61.9375em) { */
        #global-ux .optprg-tdr-pop-up-1152-content {
            top: 400px !important;
            max-width: 537px;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .splitter { 
            padding: 10px 6.59% 50px;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-tdr-pop-up-heading {
            font-size: 24px;
            font-weight: 300 !important;
            line-height: 1.42 !important;
            letter-spacing: 3px;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-tdr-pop-up-heading br {
            display: none
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-carname {
            letter-spacing: 3px;
            font-size: 24px !important;
            line-height: 1.42 !important;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-subname {
            font-size: 24px !important;
        }

        #global-ux .optprg-tdr-pop-up-1152-content #id-optprg-main-price-label {
            display: block !important;
            font-size: 16px;
            line-height: 1.63;
            letter-spacing: 1px;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-primary-button {
            height: 40px;
            font-size: 14px !important;
            line-height: 0.72;
            letter-spacing: 1px;
            padding: 13px 25px 13px 25px !important;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .splitter-column-wrap {
            display: block;
            text-align-last: center;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .splitter-column-wrap .splitter-column.large-6.columns {
            display: block;
            float: none;
            padding: 0;
            width: auto
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-tdr-pop-up-image {
            width: 60%;
            height: auto;
            max-width: unset;
            float: unset;
            margin: unset;
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-car-name span {
            display: block
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-car-name .optprg-car-name-sub-name {
            margin-top: -6px !important
        }

        #global-ux .optprg-tdr-pop-up-1152-content .optprg-info,
        #global-ux .optprg-tdr-pop-up-1152-content .optprg-co2-info,
        #global-ux .optprg-tdr-pop-up-1152-content .optprg-price-info {
            font-size: 12px !important;
            margin: 0 !important;
            padding: 0 !important
        }
    }

    @media only screen and (max-width:47.9375em) {
        #global-ux #optprg-tdr-pop-up-price-tooltip {
            top: 0 !important;
            left: 0 !important;
            height: 100%;
            width: 100%
        }
    }

    .overlay.animate {
        opacity: 1;
        visibility: visible;
        transform: translateZ(0);
        transition: opacity .2s, visibility .2s;

    }

    .overlay.is-active {
        display: block;
        position: fixed;
        z-index: 9999;
        width: 100%;
        height: unset;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
    }

    .overlay .overlay-content-wrapper {
        transform: translateZ(0);
        transition: opacity .2s, visibility .2s;
        position: fixed;
        display: block;
        width: 100%;
        height: unset;
        opacity: 1;
        z-index: 10001;
        overflow-y: auto;
        background: rgba(0, 0, 0, .8);
        top: 50%;
        left: 50%;
        -webkit-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
    }

    @media only screen and (min-width: 992px) {
        .overlay-content-wrapper {
            max-width: 1035px;
        }
    }

    .popin-1152 {
        display: none;
    }

    .optprg-price-info {
        display: none;
    }

    .overlay.optprg-tdr-pop-up-1152-content {
        font-family: FordAntenna, Ford Antenna, Arial, Helvetica, sans-serif !important;
    }

    .overlay-content {
        background-color: #fff;
        display: block;
        overflow: auto;
        /* height: 50%; */
    }

    #global-ux .overlay .overlay-content-wrapper .overlay-inner .overlay-content>.content>div:not(.tryTheTechMap):not(.youtube):not(.brightcove):not(.carousel):not(.carousel3):not(.box-content-wrapper):not(.compareVs):not(#gux3):not(.richtext-numbered-list):not(.image-left-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(.image-right-align):not(.bevImageGallery):not(.splitter):not(.box):not(.helpMeChoose),
    .overlay .overlay-content-wrapper .overlay-inner .overlay-content>.content>div:not(.tryTheTechMap):not(.youtube):not(.brightcove):not(.carousel):not(.carousel3):not(.box-content-wrapper):not(.compareVs):not(#gux3):not(.richtext-numbered-list):not(.image-left-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(.image-right-align):not(.bevImageGallery):not(.splitter):not(.box):not(.helpMeChoose) {
        padding-left: 0 !important;
        padding-right: 0 !important;
    }

    .overlay .overlay-content-wrapper .overlay-inner .overlay-content>.content>div:not(.tryTheTechMap):not(.youtube):not(.brightcove):not(.carousel):not(.carousel3):not(.box-content-wrapper):not(.compareVs):not(#gux3):not(.richtext-numbered-list):not(.image-left-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(#g3 .overlay .image-right-align):not(#gux3 .image-right-align):not(.image-right-align):not(.bevImageGallery):not(.splitter):not(.box):not(.helpMeChoose) {
        margin-left: 6%;
        margin-right: 6%;
    }
    /* h5.optprg-tdr-pop-up-price:nth-child(2) {
        display: none;
    } */
</style>
-->
<style>
    .overlay-content-wrapper.optprg-tdr-pop-up-1152-content {
        height: auto !important;
        left: 50% !important;
        position: absolute !important;
        top: 50% !important;
        transform: translate(-50%, -50%) !important;
        width: 65% !important;
    }

    .optprg-tdr-pop-up-1152-content h3.optprg-tdr-pop-up-heading {
        text-align: center;
    }

    .optprg-tdr-pop-up-1152-content span.optprg-carname,
    .optprg-tdr-pop-up-1152-content span.optprg-subname {
        font-weight: bold;
    }

    .optprg-tdr-pop-up-1152-content h4.optprg-offer-price,
    .optprg-tdr-pop-up-1152-content h4.optprg-retail-price {
        display: flex;
    }

    .optprg-tdr-pop-up-1152-content .optprg-offer-price sup,
    .optprg-tdr-pop-up-1152-content .optprg-retail-price sup {
        position: relative;
        left: 2px;
        top: 10px;
    }

    /* Desktop  */
    @media (min-width:801px) {
        .optprg-tdr-pop-up-1152-content .overlay-inner .overlay-content .box {
            padding: 0 !important;
        }

        .optprg-tdr-pop-up-1152-content .acc-tooltip-overlay {
            position: absolute !important;
            left: 50% !important;
            z-index: 10000 !important;
        }
    }

    @media screen and (min-width: 48em) {

        .optprg-tdr-pop-up-1152-content .acc-tooltip-overlay,
        #global-ux .acc-tooltip-overlay,
        .optprg-tdr-pop-up-1152-content .acc-tooltip-overlay {
            max-width: 46%;
            height: auto;
            max-height: 320px;
            overflow-y: scroll;
        }

    }

    @media screen and (min-width: 48em) {

        .optprg-tdr-pop-up-1152-content .acc-tooltip-overlay .tooltip-overlay-inner,
        .optprg-tdr-pop-up-1152-content .acc-tooltip-overlay .tooltip-overlay-inner,
        .optprg-tdr-pop-up-1152-content .acc-tooltip-overlay .tooltip-overlay-inner {
            max-height: 100% !important;
        }
    }

    .optprg-tdr-pop-up-1152-content>.acc-tooltip-overlay[id][data-position=none],
    .optprg-tdr-pop-up-1152-content>.gux-tooltip-overlay[id][data-position=none],
    body>.optprg-tdr-pop-up-1152-content.acc-tooltip-overlay[id][data-position=none],
    body>.optprg-tdr-pop-up-1152-content.gux-tooltip-overlay[id][data-position=none] {
        transform: translate(0%, -40%);
        position: fixed !important;
    }

    /* Tablet and Mobile */
    @media (max-width:768px) {
        .overlay-content-wrapper.optprg-tdr-pop-up-1152-content {
            height: 100% !important;
            margin: auto !important;
            overflow-y: auto !important;
            padding: 25px !important;
            width: 100% !important;
        }
    }
</style>